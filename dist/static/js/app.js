"use strict";function _init(){$.AdminLTE.layout={activate:function(){var e=this;$(window).load(function(){e.fix(),e.fixSidebar()}),$(window,".wrapper").resize(function(){e.fix(),e.fixSidebar()})},fix:function(){var e=$(".main-header").outerHeight()+$(".main-footer").outerHeight(),t=$(window).height(),a=$(".sidebar").height();$("body").hasClass("fixed")?$(".content-wrapper, .right-side").css("min-height",t-$(".main-footer").outerHeight()):t>=a?$(".content-wrapper, .right-side").css("min-height",t-e):$(".content-wrapper, .right-side").css("min-height",a)},fixSidebar:function(){return $("body").hasClass("fixed")?("undefined"==typeof $.fn.slimScroll&&console&&console.error("Error: the fixed layout requires the slimscroll plugin!"),void($.AdminLTE.options.sidebarSlimScroll&&"undefined"!=typeof $.fn.slimScroll&&($(".sidebar").slimScroll({destroy:!0}).height("auto"),$(".sidebar").slimscroll({height:$(window).height()-$(".main-header").height()+"px",color:"rgba(0,0,0,0.2)",size:"3px"})))):void("undefined"!=typeof $.fn.slimScroll&&$(".sidebar").slimScroll({destroy:!0}).height("auto"))}},$.AdminLTE.pushMenu=function(e){var t=this.options.screenSizes;$(e).click(function(e){e.preventDefault(),$(window).width()>t.sm-1?$("body").toggleClass("sidebar-collapse"):$("body").hasClass("sidebar-open")?($("body").removeClass("sidebar-open"),$("body").removeClass("sidebar-collapse")):$("body").addClass("sidebar-open")}),$(".content-wrapper").click(function(){$(window).width()<=t.sm-1&&$("body").hasClass("sidebar-open")&&$("body").removeClass("sidebar-open")})},$.AdminLTE.tree=function(e){var t=this;$("li a",$(e)).click(function(e){var a=$(this),n=a.next();if(n.is(".treeview-menu")&&n.is(":visible"))n.slideUp("normal",function(){n.removeClass("menu-open")}),n.parent("li").removeClass("active");else if(n.is(".treeview-menu")&&!n.is(":visible")){var i=a.parents("ul").first(),o=i.find("ul:visible").slideUp("normal");o.removeClass("menu-open");var r=a.parent("li");n.slideDown("normal",function(){n.addClass("menu-open"),i.find("li.active").removeClass("active"),r.addClass("active"),t.layout.fix()})}n.is(".treeview-menu")&&e.preventDefault()})},$.AdminLTE.boxWidget={activate:function(){var e=$.AdminLTE.options,t=this;$(e.boxWidgetOptions.boxWidgetSelectors.collapse).click(function(e){e.preventDefault(),t.collapse($(this))}),$(e.boxWidgetOptions.boxWidgetSelectors.remove).click(function(e){e.preventDefault(),t.remove($(this))})},collapse:function(e){var t=e.parents(".box").first(),a=t.find(".box-body, .box-footer");t.hasClass("collapsed-box")?(e.children(".fa-plus").removeClass("fa-plus").addClass("fa-minus"),a.slideDown(300,function(){t.removeClass("collapsed-box")})):(e.children(".fa-minus").removeClass("fa-minus").addClass("fa-plus"),a.slideUp(300,function(){t.addClass("collapsed-box")}))},remove:function(e){var t=e.parents(".box").first();t.slideUp()},options:$.AdminLTE.options.boxWidgetOptions}}if("undefined"==typeof jQuery)throw new Error("AdminLTE requires jQuery");$.AdminLTE={},$.AdminLTE.options={navbarMenuSlimscroll:!1,navbarMenuSlimscrollWidth:"3px",navbarMenuHeight:"200px",sidebarToggleSelector:'[data-toggle="offcanvas"]',sidebarPushMenu:!0,sidebarSlimScroll:!1,enableBoxRefresh:!1,enableBSToppltip:!0,BSTooltipSelector:'[data-toggle="tooltip"]',enableFastclick:!1,enableBoxWidget:!1,boxWidgetOptions:{boxWidgetIcons:{collapse:"fa fa-minus",open:"fa fa-plus",remove:"fa fa-times"},boxWidgetSelectors:{remove:'[data-widget="remove"]',collapse:'[data-widget="collapse"]'}},directChat:{enable:!1,contactToggleSelector:'[data-widget="chat-pane-toggle"]'},colors:{lightBlue:"#3c8dbc",red:"#f56954",green:"#00a65a",aqua:"#00c0ef",yellow:"#f39c12",blue:"#0073b7",navy:"#001F3F",teal:"#39CCCC",olive:"#3D9970",lime:"#01FF70",orange:"#FF851B",fuchsia:"#F012BE",purple:"#8E24AA",maroon:"#D81B60",black:"#222222",gray:"#d2d6de"},screenSizes:{xs:480,sm:768,md:992,lg:1200}},$(function(){var e=$.AdminLTE.options;_init(),$.AdminLTE.layout.activate(),$.AdminLTE.tree(".sidebar"),e.navbarMenuSlimscroll&&"undefined"!=typeof $.fn.slimscroll&&$(".navbar .menu").slimscroll({height:"200px",alwaysVisible:!1,size:"3px"}).css("width","100%"),e.sidebarPushMenu&&$.AdminLTE.pushMenu(e.sidebarToggleSelector),e.enableBSToppltip&&$(e.BSTooltipSelector).tooltip(),e.enableBoxWidget&&$.AdminLTE.boxWidget.activate(),e.enableFastclick&&"undefined"!=typeof FastClick&&FastClick.attach(document.body),e.directChat.enable&&$(e.directChat.contactToggleSelector).click(function(){var e=$(this).parents(".direct-chat").first();e.toggleClass("direct-chat-contacts-open")}),$('.btn-group[data-toggle="btn-toggle"]').each(function(){var e=$(this);$(this).find(".btn").click(function(t){e.find(".btn.active").removeClass("active"),$(this).addClass("active"),t.preventDefault()})})}),function(e){e.fn.boxRefresh=function(t){function a(e){e.append(o),i.onLoadStart.call(e)}function n(e){e.find(o).remove(),i.onLoadDone.call(e)}var i=e.extend({trigger:".refresh-btn",source:"",onLoadStart:function(e){},onLoadDone:function(e){}},t),o=e('<div class="overlay"><div class="fa fa-refresh fa-spin"></div></div>');return this.each(function(){if(""===i.source)return void(console&&console.log("Please specify a source first - boxRefresh()"));var t=e(this),o=t.find(i.trigger).first();o.click(function(e){e.preventDefault(),a(t),t.find(".box-body").load(i.source,function(){n(t)})})})}}(jQuery),function(e){e.fn.todolist=function(t){var a=e.extend({onCheck:function(e){},onUncheck:function(e){}},t);return this.each(function(){"undefined"!=typeof e.fn.iCheck?(e("input",this).on("ifChecked",function(t){var n=e(this).parents("li").first();n.toggleClass("done"),a.onCheck.call(n)}),e("input",this).on("ifUnchecked",function(t){var n=e(this).parents("li").first();n.toggleClass("done"),a.onUncheck.call(n)})):e("input",this).on("change",function(t){var n=e(this).parents("li").first();n.toggleClass("done"),a.onCheck.call(n)})})}}(jQuery),function(){if("function"!=typeof $.fn.twbsPagination)throw new Error("twbsPagination required");var e={first:"第一页",prev:"上一页",next:"下一页",last:"最后一页",paginationClass:"pagination pagination-sm no-margin pull-right"};$.extend($.fn.twbsPagination.defaults,e)}(),function(){if("function"!=typeof moment)throw new Error("moment required");moment.defaultFormat="YYYY-MM-DD"}(),function(e){e.fn.showRisk=function(){var t=this.find("td.risk-score"),a=this.find("td.local-relevance"),n=function(t){return function(a,n){var i=e(n).data("num"),o=e(n).find("i");o.slice(0,i).removeClass(t+"-o").addClass(t)}};return t.each(n("fa-star")),a.each(n("fa-square")),this}}(jQuery);var App={module:{},page:{},route:function(){var e,t,a=this.module,n=this.page,i=location.pathname,o=/^\/(\w+)\/$/,r=/^\/(\w+)\/(\d+)\/$/,s=null;switch(!0){case"/"===i:e="dashboard";break;case o.test(i):s=o.exec(i),e=s[1];break;case r.test(i):s=r.exec(i),e=s[1],t=+s[2]}return"login"===e?n.login(a):(a.search(),a.menu(i,e),void 0===t?n[e](a,i,e):n[e+"Detail"](a,i,e,t))}};App.module.login=function(){var e=document.forms.login,t=e.action,a=e.elements,n=a.username,i=a.password,o=a[2],r=$(e).find("p"),s=function(){o.disabled=!(n.value&&i.value)},l=function(a){a.preventDefault(),$.post(t,$(e).serialize(),function(e){e.status?location.href=location.search?location.search.substr(1).split("=")[1]:"/":(r.text("用户名或密码错误！"),o.disabled=!0,i.value="")})};$(e).keyup(s).submit(l)},App.module.register=function(){var e=document.forms.add,t=e.action,a=e.elements,n=a.username,i=a.password,o=a.retype,r=a[3],s=$(e).find("p"),l=function(){r.disabled=!(n.value&&i.value&&o.value)},c=function(e){e.preventDefault();var a=function(e){e.status?location.reload():s.text("抱歉，添加失败！").show()};i.value===o.value?$.post(t,$([n,i]).serialize(),a):(s.text("两次输入密码不一致！").show(),r.disabled=!0,i.value="",o.value="")};$(e).keyup(l).submit(c)},App.module.admin=function(){var e=$(".user-admin"),t=e.find("input"),a=e.find("button"),n=a.eq(0),i=a.eq(1),o=[],r=function(e,a){e.click(function(){o.length=0,t.filter(":checked").each(function(e,t){o.push($(t).parent().next().data("id"))}),o.length&&$.post(a,{id:o.toString()},function(e){e.status&&location.reload()})})};r(n,"/api/user/reset/"),r(i,"/api/user/remove/")},App.module.settings=function(){var e=document.forms.info,t=e.action,a=e.elements,n=a.username,i=a.oldPassword,o=a.newPassword,r=a.retype,s=a[4],l=$(e).find("p"),c=function(){s.disabled=!(n.value&&i.value&&o.value&&r.value)},d=function(e){e.preventDefault();var a=function(e){e.status?(l.text("更新成功！").show(),location.href="/login/"):(l.text("原密码错误！").show(),i.value="",o.value="",r.value="")};o.value===r.value?$.post(t,$([n,i,o]).serialize(),a):(l.text("两次输入密码不一致！").show(),o.value="",r.value="")};$(e).keyup(c).submit(d)},App.module.line=function(e){$.getJSON("/api/line"+e,function(e){echarts.init($("#line-chart")[0],"macarons").setOption({color:["#00a65a","#00c0ef","#dd4b39"],tooltip:{trigger:"axis"},legend:{data:["正面","中性","负面"]},grid:{x:40,y:30,x2:25,y2:30},xAxis:[{type:"category",boundaryGap:!1,data:e.date}],yAxis:[{type:"value"}],series:[{name:"正面",type:"line",data:e.positive},{name:"中性",type:"line",data:e.neutral},{name:"负面",type:"line",data:e.negative}]})})},App.module.pie=function(e){$.getJSON("/api/pie"+e,function(e){echarts.init($("#pie-chart")[0],"macarons").setOption({tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{data:e.name},series:[{name:"信息比例",type:"pie",radius:"55%",center:["50%","60%"],data:e.value}]})})},App.module.map=function(){$.getJSON("/api/map/",function(e){var t,a=e.regionData,n=[];for(var i in a)switch(n[i]=a[i].rank,n[i]){case"A":n[i]=1;break;case"B":n[i]=1;break;case"C":n[i]=2;break;case"D":n[i]=3;break;case"E":n[i]=3;break;default:n[i]=3}echarts.util.mapData.params.params.wh={getGeoJson:function(e){$.getJSON("/static/wh.json",e)}},echarts.init(document.getElementById("map-chart")).setOption({title:{subtext:""},tooltip:{trigger:"item",formatter:function(e){for(var i in a)if(e[1]===a[i].regionName)switch(t=n[i]){case 1:t="A";break;case 2:t="B";break;case 3:t="C";break;default:t="erro"}return e[1]+"<br>风险等级  "+t}},legend:{orient:"vertical",x:"right",data:[""]},dataRange:{min:0,max:3,splitNumber:3,color:["#fa9529","#fff26e","#cee19e"],formatter:function(e,t){return"1"===t?"A-低风险":"2"===t?"B-中风险":"3"===t?"C-高风险":void 0},x:"right"},series:[{name:"数据名称",type:"map",mapType:"wh",selectedMode:"single",itemStyle:{normal:{label:{show:!1}},emphasis:{label:{show:!0}}},data:[{name:"江岸区",value:n[4]},{name:"江汉区",value:n[6]},{name:"硚口区",value:n[10]},{name:"汉阳区",value:n[11]},{name:"武昌区",value:n[0]},{name:"洪山区",value:n[1]},{name:"青山区",value:n[3]},{name:"东西湖区",value:n[9]},{name:"蔡甸区",value:n[12]},{name:"江夏区",value:n[2]},{name:"黄陂区",value:n[7]},{name:"新洲区",value:n[8]},{name:"汉南区",value:n[13]}]}]})})},App.module.search=function(){var e=document.forms.search,t=e.elements.keywords;$(e).submit(function(a){a.preventDefault();var n=$.trim(t.value);n&&(e.reset(),location.href="/search/"+n+"/")})},App.module.menu=function(e,t){var a=$(".sidebar-menu"),n=a.parent(),i=function(){var a=this.getAttribute("href");switch(!0){case"dashboard"===t:return"/"===a;case"category"===t:case"location"===t:case"analytics"===t:return a===e;default:return a.split("/")[1]===t}};a.detach().find("a").filter(i).parent().addClass("active").closest(".treeview-menu").addClass("menu-open").closest(".treeview").addClass("active"),a.appendTo(n)},App.module.inspection=function(){var e=$("#inspection"),t=e.children(".box-body").find("tbody");t.load("/api/dashboard/local-inspection/"),e.on("click","button",function(e){return e.preventDefault(),$(this).hasClass("active")?!1:($(this).addClass("active").siblings().removeClass("active"),void t.load("/api/dashboard/"+this.id+"/"))})},App.module.returnTop=function(e){var t=e.offset().top,a=t>160?t-120:0;$("body").animate({scrollTop:a})},App.module.paginate=function(e){var t=this.returnTop.bind(this);$.get(e.api,e.filter(),function(a){return a.html?(e.render(e.container,a.html),void $(e.container).closest(".box-body").twbsPagination({totalPages:a.total,onPageClick:function(a,n){t($(this)),$.get(e.api,e.filter(n),function(t){e.render(e.container,t.html)})}})):!1})},App.module["abstract"]=function(e){e=$.extend({feature:"",container:"",render:function(e,t){$("<div/>").attr({id:this.feature,"class":"list-group no-margin"}).html(t).find('[data-toggle="tooltip"]').tooltip().end().replaceAll($(e))}},e),$.get("/api/"+e.feature+"/",{type:"abstract"},function(t){e.render(e.container,t.html)})},App.module.list=function(e){e=$.extend(!0,{feature:"",filter:{type:"list",page:1},container:"",render:function(e,t){$(e).html(t)},visiblePages:7},e),$.extend($.fn.twbsPagination.defaults,{visiblePages:e.visiblePages});var t="/api/"+e.feature+"/",a=function(t){return"number"!=typeof t?e.filter:$.extend({},e.filter,{page:t})};this.paginate({api:t,filter:a,container:e.container,render:e.render})},App.module.detail=function(e){e=$.extend(!0,{path:"",feature:"",container:"",render:function(e,t){$(e).html(t)}},e),$.extend($.fn.twbsPagination.defaults,{visiblePages:7});var t="/api"+e.path+e.feature+"/",a=function(e){return"number"!=typeof e?{page:1}:{page:e}};this.paginate({api:t,filter:a,container:e.container,render:e.render})},App.module.collect=function(e,t){$(".collection").click(function(){var a=$(this).find("i"),n=$(this).find("span"),i=function(i,o){var r={type:"news"===e?"article":"topic",id:t};$.post(i,r,function(e){e.status&&(a.toggleClass("fa-star-o"),a.toggleClass("fa-star"),n.text(o))})};a.hasClass("fa-star")?i("/api/collection/remove/","添加收藏"):i("/api/collection/add/","取消收藏")})},App.module.dataTable=function(e){$.fn.dataTable.ext.errMode="throw",$(".initDataTable").each(function(){var t=$(this).DataTable({ajax:{url:"/api"+e,dataSrc:this.id,cache:!0},autoWidth:!1,pageLength:25,order:[],language:{processing:"处理中...",search:"",searchPlaceholder:"输入关键字过滤...",lengthMenu:"显示 _MENU_ 条",info:"显示第 _START_ 至 _END_ 条，共 _TOTAL_ 条",infoEmpty:"信息空",infoFiltered:"(由 _MAX_ 项结果过滤)",infoPostFix:"",loadingRecords:"载入中...",zeroRecords:"无匹配结果",emptyTable:"无结果",paginate:{first:"第一页",previous:"上一页",next:"下一页",last:"最后一页"},aria:{sortAscending:"正序排列",sortDescending:"倒序排列"}},deferLoading:100,drawCallback:function(){$('[data-toggle="tooltip"]').tooltip()}});t.on("click","tbody > tr",function(){$(this).hasClass("selected")?$(this).removeClass("selected"):(t.$("tr.selected").removeClass("selected"),$(this).addClass("selected"))})})},App.module.dateRange=function(e){e.on("show.dateRange",function(e,t,a){$(this).children("span").html(t+" ~ "+a)}).daterangepicker({ranges:{"过去7天":[moment().subtract(6,"days"),moment()],"过去30天":[moment().subtract(29,"days"),moment()],"这个月":[moment().startOf("month"),moment().endOf("month")],"上个月":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")]},locale:{format:"YYYY-MM-DD",separator:" - ",applyLabel:"确定",cancelLabel:"取消",fromLabel:"从",toLabel:"到",customRangeLabel:"自定义"},startDate:moment().subtract(6,"days"),endDate:moment(),minDate:"2010-01-01",maxDate:moment(),opens:"left",parentEl:".content-header",applyClass:"btn-success",cancelClass:"btn-default"})},App.module.statistic=function(e,t){var a=e.find(".statistic-total > span"),n=e.find(".statistic-risk > span");e.on("show.statistic",function(e,i,o){$.getJSON(t,{type:"statistic",start:i,end:o},function(e){a.text(e.total),n.text(e.risk)})})},App.page.login=function(e){e.login()},App.page.settings=function(e){e.settings()},App.page.user=function(e){e.admin(),e.register()},App.page.dashboard=function(e,t){$(".info-box-content").each(function(e,t){var a=$(t).find(".info-box-number"),n=$(t).find(".progress-bar"),i=$(t).find(".progress-description"),o=2e3,r=100,s=Math.floor(o/r),l=0,c=0,d=$(t).data("number"),u=d/s,p=0,f=$(t).data("percent"),m=f/s,h=function(e,t){a.text(e),n.width(t+"%"),i.text("占总数据 "+t+"%")},g=function(){s>l?(c+=u,p+=m,h(c.toFixed(),p.toFixed()),l++,setTimeout(g,r)):(c=d,p=f,h(c,p))};setTimeout(g,r)}),e.map(t),e["abstract"]({feature:"risk",container:"#risk > tbody",render:function(e,t){$("<tbody/>").html(t).showRisk().replaceAll($(e))}}),e.line(t),e.pie(t),e.inspection(),e["abstract"]({feature:"news",container:"#news"}),e["abstract"]({feature:"event",container:"#event"}),e["abstract"]({feature:"weixin",container:"#weixin",render:function(e,t){$(e).html(t)}}),e["abstract"]({feature:"weibo",container:"#weibo",render:function(e,t){$(e).html(t)}})},App.page.news=function(e){e.list({feature:"news",container:"#news > tbody"})},App.page.newsDetail=function(e,t,a,n){e.collect(a,n)},App.page.event=function(e){e.list({feature:"event",container:"#event > tbody"})},App.page.eventDetail=function(e,t,a,n){e.collect(a,n),e.line(t,a),e.pie(t,a),e.detail({path:t,feature:"news",container:"#news > tbody"}),e.detail({path:t,feature:"weixin",container:"#weixin"}),e.detail({path:t,feature:"weibo",container:"#weibo"})},App.page.weixin=function(e){e.list({feature:"weixin",filter:{sort:"new"},container:"#weixin-new",visiblePages:3}),e.list({feature:"weixin",filter:{sort:"hot"},container:"#weixin-hot",visiblePages:3})},App.page.weixinDetail=function(){},App.page.weibo=function(e){e.list({feature:"weibo",filter:{sort:"new"},container:"#weibo-new",visiblePages:3}),e.list({feature:"weibo",filter:{sort:"hot"},container:"#weibo-hot",visiblePages:3})},App.page.categoryDetail=function(e,t){e.detail({path:t,feature:"news",container:"#news > tbody"})},App.page.locationDetail=function(e,t){e.detail({path:t,feature:"news",container:"#news > tbody"}),e.detail({path:t,feature:"weixin",container:"#weixin"}),e.detail({path:t,feature:"weibo",container:"#weibo"})},App.page.inspection=function(e,t){e.dataTable(t)},App.page.custom=function(){var e=document.forms.addKeyword,t=e.action,a=e.elements,n=a[0],i=a[1],o=a[2],r=$(e).prev(),s=$(e).parent().prev().find("li"),l=function(){o.disabled=!i.value},c=function(a){a.preventDefault(),$.post(t,$(e).serialize(),function(e){e.status?(r.text("关键词添加成功！").show(),location.reload()):(r.text("关键词添加失败！").show(),i.value="")})};s.length>=5?n.disabled=!0:$(e).keyup(l).submit(c)},App.page.customDetail=function(e,t){e.detail({path:t,feature:"news",container:"#news > tbody"}),e.detail({path:t,feature:"weixin",container:"#weixin"}),e.detail({path:t,feature:"weibo",container:"#weibo"})},App.page.collection=function(e,t){e.detail({path:t,feature:"news",container:"#news > tbody"}),e.detail({path:t,feature:"event",container:"#event > tbody"})},App.page.risk=function(e){e.list({feature:"risk",container:"#risk > tbody",render:function(e,t){$("<tbody/>").html(t).showRisk().replaceAll($(e))}})},App.page.riskDetail=function(e,t,a,n){e.collect(a,n),e.line(t,a),e.pie(t,a),e.detail({path:t,feature:"news",container:"#news > tbody"}),e.detail({path:t,feature:"weixin",container:"#weixin"}),e.detail({path:t,feature:"weibo",container:"#weibo"})},App.page.analyticsDetail=function(e,t){var a="/api"+t,n=$(".date-range-picker"),i=$("#chart"),o=$("#statistic"),r=moment().subtract(6,"days").format(),s=moment().format();e.dateRange(n),n.trigger("show.dateRange",[r,s]),i.on("show.chart",function(e,t,n){var i={},o=$(this).find(".tab-pane.active")[0].id.slice(6),r=function(e){var i={show:!0,title:"保存为Excel",icon:"image://../../static/img/excel.png",onclick:function(){document.getElementById("save-as-excel").src=a+"?type="+e+"&start="+t+"&end="+n+"&datatype=xls"}};return i};i.trend=function(e,t){$.getJSON(a,{type:"chart-trend",start:e,end:t},function(e){echarts.init(document.getElementById("chart-trend"),"macarons").setOption({tooltip:{backgroundColor:"rgba(50,50,50,0.5)",trigger:"axis",axisPointer:{type:"line",lineStyle:{color:"#008acd"}}},shadowStyle:{color:"rgba(200,200,200,0.2)"},legend:{data:["全部","新闻","微博","微信"]},grid:{x:50,y:30,x2:25,y2:65},toolbox:{show:!0,feature:{myTool:r("chart-trend"),saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",boundaryGap:!1,data:e.date}],yAxis:[{type:"value"}],series:[{name:"全部",type:"line",data:e.total},{name:"新闻",type:"line",data:e.news},{name:"微博",type:"line",data:e.weibo},{name:"微信",type:"line",data:e.weixin}]})})},i.type=function(e,t){$.getJSON(a,{type:"chart-type",start:e,end:t},function(e){echarts.init(document.getElementById("chart-type"),"macarons").setOption({tooltip:{backgroundColor:"rgba(50,50,50,0.5)",trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",x:"left",y:"bottom",data:["新闻","微博","微信"]},toolbox:{show:!0,feature:{myTool:r("chart-type"),saveAsImage:{show:!0}}},calculable:!0,series:[{name:"访问来源",type:"pie",radius:"55%",center:["50%","60%"],data:[{value:e.news,name:"新闻"},{value:e.weibo,name:"微博"},{value:e.weixin,name:"微信"}]}]})})},i.emotion=function(e,t){$.getJSON(a,{type:"chart-emotion",start:e,end:t},function(e){echarts.init(document.getElementById("chart-emotion"),"macarons").setOption({tooltip:{backgroundColor:"rgba(50,50,50,0.5)",trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",x:"left",y:"bottom",data:["正面","中性","负面"]},toolbox:{show:!0,feature:{mark:{show:!1},myTool:r("chart-emotion"),magicType:{show:!1,type:["pie"],option:{funnel:{x:"25%",width:"50%",funnelAlign:"left",max:2e3}}},restore:{show:!1},saveAsImage:{show:!0}}},calculable:!0,series:[{name:"访问来源",type:"pie",radius:"55%",center:["50%","60%"],data:[{value:e.positive,name:"正面"},{value:e.normal,name:"中性"},{value:e.negative,name:"负面"}]}]})})},i.weibo=function(e,t){$.getJSON(a,{type:"chart-weibo",start:e,end:t},function(e){echarts.init(document.getElementById("chart-weibo-map"),"macarons").setOption({tooltip:{trigger:"item"},legend:{show:!1,orient:"vertical",x:"left",data:["微博文"]},dataRange:{min:0,max:e.value[9],x:"left",y:"bottom",text:["高","低"],calculable:!0},toolbox:{show:!0,orient:"horizontal",x:"left",y:"top",feature:{myTool:r("chart-weibo"),saveAsImage:{show:!0}}},roamController:{show:!0,x:"85%",mapTypeControl:{china:!0}},series:[{name:"微博文",type:"map",mapType:"china",roam:!1,itemStyle:{normal:{label:{show:!0}},emphasis:{label:{show:!0}}},data:e.province}]}),echarts.init(document.getElementById("chart-weibo-bar"),"macarons").setOption({title:{text:"微博地域分析",x:45},tooltip:{show:!1,trigger:"axis",axisPointer:{type:"shadow"}},legend:{show:!1,data:["微博文"]},toolbox:{show:!1,feature:{mark:{show:!0},magicType:{show:!0,type:["line","bar","stack","tiled"]},restore:{show:!0},saveAsImage:{show:!0}}},calculable:!1,grid:{borderWidth:0},xAxis:[{show:!1,type:"value"}],yAxis:[{show:!0,axisLine:!1,axisTick:!1,type:"category",splitLine:!1,splitArea:{show:!1},axisLabel:{show:!0,textStyle:{fontSize:14,fontWeight:"bolder"}},data:e.name}],series:[{name:"微博文",type:"bar",stack:"总量",barWidth:20,itemStyle:{normal:{label:{show:!0,textStyle:{color:"#000000",fontSize:14,fontWeight:"bolder"},position:"right"},color:"#3C8DBC"}},data:e.value}]})})},i[o](t,n)}),i.trigger("show.chart",[r,s]),e.statistic(o,a),o.trigger("show.statistic",[r,s]),i.on("shown.bs.tab",function(){i.trigger("show.chart",[r,s])}),n.on("apply.daterangepicker",function(e,t){r=t.startDate.format(),s=t.endDate.format(),n.trigger("show.dateRange",[r,s]),i.trigger("show.chart",[r,s]),o.trigger("show.statistic",[r,s])})},$(function(){App.route()});